{"version":3,"sources":["../../src/pages/game/game.module.ts","../../src/pages/game/game.ts","../../node_modules/rxjs/add/operator/map.js"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { GamePage } from './game';\n// import { ComponentsModule } from '../../components/components.module'\n\n@NgModule({\n  declarations: [\n    GamePage,\n    \n  ],\n  imports: [\n    IonicPageModule.forChild(GamePage),\n    // ComponentsModule\n  ],\n\n})\nexport class GamePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/game/game.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { AngularFireDatabase } from 'angularfire2/database';\nimport { AuthService } from '../../services/auth.service';\nimport { RoomsService } from '../../services/rooms.service';\nimport {CategoryModel } from '../../Models/category.model';\nimport { ChangeDetectorRef, ChangeDetectionStrategy } from '@angular/core';\nimport 'rxjs/add/operator/map';\n\n@IonicPage()\n@Component({\n  selector: 'page-game',\n  templateUrl: 'game.html',\n})\nexport class GamePage {\n  roomKey: string;\n  photoImage: string;\n  subjectTitle: string;\n  categoryTitle: string;\n  isSpy: Boolean;\n  roundKey: string;\n  second: number = 0;\n  min: number;\n  id: any;\n  lastSeconds: boolean;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams,  public af: AngularFireDatabase,\n              private authService: AuthService, private roomsService: RoomsService, private cd : ChangeDetectorRef) {\n\n    this.roundKey = this.navParams.get('roundKey');\n    \n    let subscription =this.af.object(`rounds/${roomsService.currentRoom.$key}/${this.roundKey}`).subscribe( round => {\n      if(round.spyKey == this.authService.currentUser.$key){\n        this.drawSpy();\n        subscription.unsubscribe();\n      }\n      else {\n        this.drawRandomCard(round.secret, round.categoryKey);\n        subscription.unsubscribe();\n      }\n\n      // set the spy so we could know him in the future\n      this.roomsService.setSpy(round.spyKey);\n    });\n\n    this.af.object(`/settings/${roomsService.currentRoom.settingsKey}`).subscribe( set=> {\n      console.log(\"set.timeElapsed \" + set.timeElapsed);\n      console.log(\"settigns \" + roomsService.currentRoom.settingsKey);\n      this.min = set.timeElapsed;\n    });\n\n    this.id = setInterval(()=> {\n       if(this.second == 0){\n         this.second = 59;\n         this.min--;\n       }\n       else {\n         this.second--;\n       }\n       if(this.second == 30 && this.min == 0)\n        this.lastSeconds = true;\n       if(this.second == 0 && this.min == 0) {\n         clearInterval(this.id);\n         this.LeaveGame();\n       }\n       cd.markForCheck();\n    }, 1000); \n  }\n\n  private drawRandomCard(subject: number, categoryKey: string) {\n    this.af.object(`categories/${categoryKey}/`).subscribe( category =>{\n      let catModel: CategoryModel = category;\n      this.categoryTitle = catModel.title;\n      this.photoImage = catModel.members[subject].url; \n      this.subjectTitle = catModel.members[subject].title; \n    });\n  }\n  \n  private drawSpy() {\n    this.photoImage = \"assets/spy2.png\";\n    this.subjectTitle = \"Mole\";\n    this.isSpy = true;\n  }\n\n  public LeaveGame() {\n      this.navCtrl.push('EndGamePage', {\n      roundKey: this.roundKey\n    });\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/game/game.ts","\"use strict\";\nvar Observable_1 = require('../../Observable');\nvar map_1 = require('../../operator/map');\nObservable_1.Observable.prototype.map = map_1.map;\n//# sourceMappingURL=map.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs/add/operator/map.js\n// module id = 467\n// module chunks = 0"],"sourceRoot":""}